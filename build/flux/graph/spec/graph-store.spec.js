define(['exports', '../graph-store', '../../../testing/dispatcher-mock', '../../../testing/diff', './data', 'immutable', '../../history/history-actions', '../graph-actions', '../graph-model'], function (exports, _graphStore, _testingDispatcherMock, _testingDiff, _data, _immutable, _historyHistoryActions, _graphActions, _graphModel) {'use strict';function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { 'default': obj };}var _GraphStore = _interopRequireDefault(_graphStore);var _DispatcherMock = _interopRequireDefault(_testingDispatcherMock);var _diff = _interopRequireDefault(_testingDiff);var _data2 = _interopRequireDefault(_data);












  function dummyGraph() {
    return _graphModel.convert.graph(_data2['default'].initial.graph);}


  function dummyTypes() {
    return _graphModel.convert.types(_data2['default'].initial.types);}



  // Jasmine:
  var jasmine = window.jasmine;var describe = window.describe;var beforeEach = window.beforeEach;var expect = window.expect;var it = window.it;var 
  any = jasmine.any;

  describe('A graph store', function () {

    var dispatcher;
    var store;

    beforeEach(function () {
      dispatcher = new _DispatcherMock['default']();
      store = new _GraphStore['default'](dispatcher, dummyGraph(), dummyTypes());});


    it('handles graph state actions', function () {
      expect(dispatcher.register).
      toHaveBeenCalledWith(_graphActions.ConnectPort, any(Function));
      expect(dispatcher.register).
      toHaveBeenCalledWith(_graphActions.DisconnectPort, any(Function));
      expect(dispatcher.register).
      toHaveBeenCalledWith(_graphActions.RemoveEdge, any(Function));
      expect(dispatcher.register).
      toHaveBeenCalledWith(_graphActions.RemoveVertex, any(Function));});


    it('stores its initial state to history', function () {
      expect(dispatcher.dispatch).
      toHaveBeenCalledWith((0, _historyHistoryActions.SaveState)({ 
        storeId: 'GraphStore', 
        state: _immutable.List.of(dummyGraph(), dummyTypes()) }));});



    describe('asked to remove a vertex', function () {
      beforeEach(function () {
        dispatcher.handleAction((0, _graphActions.RemoveVertex)({ vertexId: 'vA' }));});


      it('removes it from the graph state', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        delete expected.vertices.vA;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to remove a vertex owning simple edges', function () {
      beforeEach(function () {
        dispatcher.handleAction((0, _graphActions.RemoveVertex)({ vertexId: 'vC' }));});


      it('removes it from the graph state along with edges owned by the vertex', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        delete expected.vertices.vC;
        expected.vertices.vA.ports.outbound[1].edgeId = null;
        expected.vertices.vB.ports.outbound[1].edgeId = null;
        delete expected.edges.a0;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to disconnect a slave port from a complex edge with 3 members', function () {
      beforeEach(function () {
        var vertex = store.graph.vertices.get('vC');
        var port = vertex.ports.inbound.get(0);
        dispatcher.handleAction((0, _graphActions.DisconnectPort)({ 
          vertex: vertex, 
          port: port }));});



      it('removes it from the graph state', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        expected.vertices.vC.ports.inbound[0].edgeId = null;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to disconnect a master port from a complex edge with 3 members', function () {
      beforeEach(function () {
        var vertex = store.graph.vertices.get('vB');
        var port = vertex.ports.outbound.get(0);
        dispatcher.handleAction((0, _graphActions.DisconnectPort)({ 
          vertex: vertex, 
          port: port }));});



      it('removes it from the graph state', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        expected.vertices.vB.ports.outbound[0].edgeId = null;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to disconnect the owning port from a simple edge', function () {
      var expected;
      beforeEach(function () {
        var vertex = store.graph.vertices.get('vC');
        var port = vertex.ports.inbound.get(3);
        dispatcher.handleAction((0, _graphActions.DisconnectPort)({ 
          vertex: vertex, 
          port: port }));

        expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();});


      it('removes the entire edge from the graph state', function () {
        var actual = store.graph.toJS();
        delete expected.edges.a0;
        expected.vertices.vC.ports.inbound[3].edgeId = null;
        expected.vertices.vA.ports.outbound[1].edgeId = null;
        expected.vertices.vB.ports.outbound[1].edgeId = null;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to disconnect a non-owning port from a simple edge with 3 members', function () {
      var expected;
      beforeEach(function () {
        var vertex = store.graph.vertices.get('vB');
        var port = vertex.ports.outbound.get(1);
        dispatcher.handleAction((0, _graphActions.DisconnectPort)({ 
          vertex: vertex, 
          port: port }));

        expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        expected.vertices.vB.ports.outbound[1].edgeId = null;});


      it('just disconnects the port', function () {
        var actual = store.graph.toJS();
        expect((0, _diff['default'])(expected, actual)).toEqual({});});


      describe('then asked to disconnect the remaining non-owning port', function () {
        beforeEach(function () {
          var vertex = store.graph.vertices.get('vA');
          var port = vertex.ports.outbound.get(1);
          dispatcher.handleAction((0, _graphActions.DisconnectPort)({ 
            vertex: vertex, 
            port: port }));

          expected.vertices.vA.ports.outbound[1].edgeId = null;});


        it('removes the entire edge from the graph state', function () {
          var actual = store.graph.toJS();
          delete expected.edges.a0;
          expected.vertices.vC.ports.inbound[3].edgeId = null;
          expect((0, _diff['default'])(expected, actual)).toEqual({});});});});




    describe('asked to remove a simple edge', function () {
      beforeEach(function () {
        dispatcher.handleAction((0, _graphActions.RemoveEdge)({ edgeId: 'a0' }));});


      it('removes that edge', function () {
        var actual = store.graph.toJS();
        expect(actual.edges.a0).not.toBeDefined();});


      it('disconnects all ports connected to it', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        delete expected.edges.a0;
        expected.vertices.vA.ports.outbound[1].edgeId = null;
        expected.vertices.vB.ports.outbound[1].edgeId = null;
        expected.vertices.vC.ports.inbound[3].edgeId = null;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('asked to remove a complex edge', function () {
      beforeEach(function () {
        dispatcher.handleAction((0, _graphActions.RemoveEdge)({ edgeId: 'r0' }));});


      it('removes that edge', function () {
        var actual = store.graph.toJS();
        expect(actual.edges.r0).not.toBeDefined();});


      it('disconnects all ports connected to it', function () {
        var actual = store.graph.toJS();
        var expected = _graphModel.convert.graph(_data2['default'].initial.graph).toJS();
        delete expected.edges.r0;
        expected.vertices.vB.ports.outbound[0].edgeId = null;
        expected.vertices.vC.ports.inbound[0].edgeId = null;
        expected.vertices.vD.ports.inbound[0].edgeId = null;
        expect((0, _diff['default'])(expected, actual)).toEqual({});});});



    describe('called to generate rename rules', function () {
      var rules;
      beforeEach(function () {
        var pseudoSelection = _graphModel.convert.graph({ 
          vertices: { vA: _data2['default'].initial.graph.vertices.vA }, 
          edges: { a0: _data2['default'].initial.graph.edges.a0 } });

        rules = store.renameRules(pseudoSelection);});


      it('provides a map to an isomorphic graph, disjoint to its own', function () {
        expect(rules.toJS()).toEqual({ 
          vertices: { 'vA': 'vA 1' }, 
          edges: { 'a0': 'a0 1' } });});});




    describe('called to apply rename rules', function () {
      var result;
      beforeEach(function () {
        var pseudoSelection = _graphModel.convert.graph({ 
          vertices: { 
            vA: _data2['default'].initial.graph.vertices.vA, 
            vB: _data2['default'].initial.graph.vertices.vB }, 

          edges: { a0: _data2['default'].initial.graph.edges.a0 } });

        var rules = (0, _immutable.Map)({ 
          vertices: (0, _immutable.Map)({ 'vA': 'vA 1' }), 
          edges: (0, _immutable.Map)({ 'a0': 'a0 1' }) });

        result = store.applyRenameRules(pseudoSelection, rules);});


      it('generates an isomorphic graph based on these rules', function () {
        var expected = _graphModel.convert.graph({ 
          vertices: { 
            'vA 1': _data2['default'].initial.graph.vertices.vA, 
            vB: _data2['default'].initial.graph.vertices.vB }, 

          edges: { 'a0 1': _data2['default'].initial.graph.edges.a0 } }).
        toJS();
        expected.edges['a0 1'].id = 'a0 1';
        expected.vertices['vA 1'].id = 'vA 1';
        expected.vertices['vA 1'].ports.outbound[1].edgeId = 'a0 1';
        expected.vertices['vB'].ports.outbound[1].edgeId = 'a0 1';
        expect((0, _diff['default'])(expected, result.toJS())).toEqual({});});});



    describe('called to insert a disjoint graph', function () {
      beforeEach(function () {
        var pseudoSelection = _graphModel.convert.graph({ 
          vertices: { vA: _data2['default'].initial.graph.vertices.vA }, 
          edges: { a0: _data2['default'].initial.graph.edges.a0 } });

        var rules = (0, _immutable.Map)({ 
          vertices: (0, _immutable.Map)({ 'vA': 'vA 1' }), 
          edges: (0, _immutable.Map)({ 'a0': 'a0 1' }) });

        var subGraph = store.applyRenameRules(pseudoSelection, rules);
        store.insert(subGraph);});


      it('extends its own graph with the supplied graph', function () {
        var vA1 = copy(_data2['default'].initial.graph.vertices.vA);
        vA1.id = 'vA 1';
        vA1.ports.outbound[1].edgeId = 'a0 1';
        var a01 = copy(_data2['default'].initial.graph.edges.a0);
        a01.id = 'a0 1';
        var expected = copy(_data2['default'].initial.graph);
        expected.edges['a0 1'] = a01;
        expected.vertices['vA 1'] = vA1;
        expect((0, _diff['default'])(expected, store.graph.toJS())).toEqual({});});});



    describe('called to insert an overlapping graph with rename rules', function () {
      beforeEach(function () {
        var pseudoSelection = _graphModel.convert.graph({ 
          vertices: { vA: _data2['default'].initial.graph.vertices.vA }, 
          edges: { a0: _data2['default'].initial.graph.edges.a0 } });

        var rules = (0, _immutable.Map)({ 
          vertices: (0, _immutable.Map)({ 'vA': 'vA 1' }), 
          edges: (0, _immutable.Map)({ 'a0': 'a0 1' }) });

        store.insert(pseudoSelection, rules);});


      it('extends its own graph with the renamed supplied graph', function () {
        var vA1 = copy(_data2['default'].initial.graph.vertices.vA);
        vA1.id = 'vA 1';
        vA1.ports.outbound[1].edgeId = 'a0 1';
        var a01 = copy(_data2['default'].initial.graph.edges.a0);
        a01.id = 'a0 1';
        var expected = copy(_data2['default'].initial.graph);
        expected.edges['a0 1'] = a01;
        expected.vertices['vA 1'] = vA1;
        expect((0, _diff['default'])(expected, store.graph.toJS())).toEqual({});});});});





  function copy(o) {
    return JSON.parse(JSON.stringify(o));}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9mbHV4L2dyYXBoL3NwZWMvZ3JhcGgtc3RvcmUuc3BlYy5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQWFBLFdBQVMsVUFBVSxHQUFHO0FBQ3BCLFdBQU8sWUFKQSxPQUFPLENBSUMsS0FBSyxDQUFFLGtCQUFLLE9BQU8sQ0FBQyxLQUFLLENBQUUsQ0FBQyxDQUM1Qzs7O0FBRUQsV0FBUyxVQUFVLEdBQUc7QUFDcEIsV0FBTyxZQVJBLE9BQU8sQ0FRQyxLQUFLLENBQUUsa0JBQUssT0FBTyxDQUFDLEtBQUssQ0FBRSxDQUFDLENBQzVDOzs7OztNQUlPLE9BQU8sR0FBdUMsTUFBTSxDQUFwRCxPQUFPLEtBQUUsUUFBUSxHQUE2QixNQUFNLENBQTNDLFFBQVEsS0FBRSxVQUFVLEdBQWlCLE1BQU0sQ0FBakMsVUFBVSxLQUFFLE1BQU0sR0FBUyxNQUFNLENBQXJCLE1BQU0sS0FBRSxFQUFFLEdBQUssTUFBTSxDQUFiLEVBQUU7QUFDekMsS0FBRyxHQUFLLE9BQU8sQ0FBZixHQUFHOztBQUVYLFVBQVEsQ0FBRSxlQUFlLEVBQUUsWUFBTTs7QUFFL0IsUUFBSSxVQUFVLENBQUM7QUFDZixRQUFJLEtBQUssQ0FBQzs7QUFFVixjQUFVLENBQUUsWUFBTTtBQUNoQixnQkFBVSxHQUFHLGdDQUFvQixDQUFDO0FBQ2xDLFdBQUssR0FBRywyQkFBZ0IsVUFBVSxFQUFFLFVBQVUsRUFBRSxFQUFFLFVBQVUsRUFBRSxDQUFFLENBQUMsQ0FDbEUsQ0FBRSxDQUFDOzs7QUFFSixNQUFFLENBQUUsNkJBQTZCLEVBQUUsWUFBTTtBQUN2QyxZQUFNLENBQUUsVUFBVSxDQUFDLFFBQVEsQ0FBRTtBQUMxQiwwQkFBb0IsZUE5QnpCLFdBQVcsRUE4QjZCLEdBQUcsQ0FBRSxRQUFRLENBQUUsQ0FBRSxDQUFDO0FBQ3hELFlBQU0sQ0FBRSxVQUFVLENBQUMsUUFBUSxDQUFFO0FBQzFCLDBCQUFvQixlQWhDWixjQUFjLEVBZ0Nn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Q2xDLGNBQU0sQ0FBRSxzQkFBTSxRQUFRLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBRSxDQUFFLENBQUMsT0FBTyxDQUFFLEVBQUUsQ0FBRSxDQUFDLENBQzlELENBQUUsQ0FBQyxDQUNMLENBQUUsQ0FBQyxDQUVMLENBQUUsQ0FBQzs7Ozs7O0FBRUosV0FBUyxJQUFJLENBQUUsQ0FBQyxFQUFHO0FBQ2pCLFdBQU8sSUFBSSxDQUFDLEtBQUssQ0FBRSxJQUFJLENBQUMsU0FBUyxDQUFFLENBQUMsQ0FBRSxDQUFFLENBQUMsQ0FDMUMiLCJmaWxlIjoiZ3JhcGgtc3RvcmUuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiJzcmMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR3JhcGhTdG9yZSBmcm9tICcuLi9ncmFwaC1zdG9yZSc7XG5pbXBvcnQgRGlzcGF0Y2hlck1vY2sgZnJvbSAnLi4vLi4vLi4vdGVzdGluZy9kaXNwYXRjaGVyLW1vY2snO1xuaW1wb3J0IGRpZmYgZnJvbSAnLi4vLi4vLi4vdGVzdGluZy9kaWZmJztcblxuaW1wb3J0IGRhdGEgZnJvbSAnLi9kYXRhJztcbmltcG9ydCB7IExpc3QsIE1hcCB9IGZyb20gJ2ltbXV0YWJsZSc7XG5pbXBvcnQgeyBTYXZlU3RhdGUgfSBmcm9tICcuLi8uLi9oaXN0b3J5L2hpc3RvcnktYWN0aW9ucyc7XG5pbXBvcnQge1xuICBDb25uZWN0UG9ydCwgRGlzY29ubmVjdFBvcnQsIFJlbW92ZVZlcnRleCwgUmVtb3ZlRWRnZVxufSBmcm9tICcuLi9ncmFwaC1hY3Rpb25zJztcbmltcG9ydCB7IGNvbnZlcnQgfSBmcm9tICcuLi9ncmFwaC1tb2RlbCc7XG5cblxuZnVuY3Rpb24gZHVtbXlHcmFwaCgpIHtcbiAgcmV0dXJuIGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApO1xufVxuXG5mdW5jdGlvbiBkdW1teVR5cGVzKCkge1xuICByZXR1cm4gY29udmVydC50eXBlcyggZGF0YS5pbml0aWFsLnR5cGVzICk7XG59XG5cblxuLy8gSmFzbWluZTpcbmNvbnN0IHsgamFzbWluZSwgZGVzY3JpYmUsIGJlZm9yZUVhY2gsIGV4cGVjdCwgaXQgfSA9IHdpbmRvdztcbmNvbnN0IHsgYW55IH0gPSBqYXNtaW5lO1xuXG5kZXNjcmliZSggJ0EgZ3JhcGggc3RvcmUnLCAoKSA9PiB7XG5cbiAgdmFyIGRpc3BhdGNoZXI7XG4gIHZhciBzdG9yZTtcblxuICBiZWZvcmVFYWNoKCAoKSA9PiB7XG4gICAgZGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyTW9jaygpO1xuICAgIHN0b3JlID0gbmV3IEdyYXBoU3RvcmUoIGRpc3BhdGNoZXIsIGR1bW15R3JhcGgoKSwgZHVtbXlUeXBlcygpICk7XG4gIH0gKTtcblxuICBpdCggJ2hhbmRsZXMgZ3JhcGggc3RhdGUgYWN0aW9ucycsICgpID0+IHtcbiAgICBleHBlY3QoIGRpc3BhdGNoZXIucmVnaXN0ZXIgKVxuICAgICAgLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCBDb25uZWN0UG9ydCwgYW55KCBGdW5jdGlvbiApICk7XG4gICAgZXhwZWN0KCBkaXNwYXRjaGVyLnJlZ2lzdGVyIClcbiAgICAgIC50b0hhdmVCZWVuQ2FsbGVkV2l0aCggRGlzY29ubmVjdFBvcnQsIGFueSggRnVuY3Rpb24gKSApO1xuICAgIGV4cGVjdCggZGlzcGF0Y2hlci5yZWdpc3RlciApXG4gICAgICAudG9IYXZlQmVlbkNhbGxlZFdpdGgoIFJlbW92ZUVkZ2UsIGFueSggRnVuY3Rpb24gKSApO1xuICAgIGV4cGVjdCggZGlzcGF0Y2hlci5yZWdpc3RlciApXG4gICAgICAudG9IYXZlQmVlbkNhbGxlZFdpdGgoIFJlbW92ZVZlcnRleCwgYW55KCBGdW5jdGlvbiApICk7XG4gIH0gKTtcblxuICBpdCggJ3N0b3JlcyBpdHMgaW5pdGlhbCBzdGF0ZSB0byBoaXN0b3J5JywgKCkgPT4ge1xuICAgIGV4cGVjdCggZGlzcGF0Y2hlci5kaXNwYXRjaCApXG4gICAgICAudG9IYXZlQmVlbkNhbGxlZFdpdGgoIFNhdmVTdGF0ZSh7XG4gICAgICAgIHN0b3JlSWQ6ICdHcmFwaFN0b3JlJyxcbiAgICAgICAgc3RhdGU6IExpc3Qub2YoIGR1bW15R3JhcGgoKSwgZHVtbXlUeXBlcygpIClcbiAgICAgIH0pICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2Fza2VkIHRvIHJlbW92ZSBhIHZlcnRleCcsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCAoKSA9PiB7XG4gICAgICBkaXNwYXRjaGVyLmhhbmRsZUFjdGlvbiggUmVtb3ZlVmVydGV4KHsgdmVydGV4SWQ6ICd2QScgfSkgKTtcbiAgICB9ICk7XG5cbiAgICBpdCggJ3JlbW92ZXMgaXQgZnJvbSB0aGUgZ3JhcGggc3RhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICBjb25zdCBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApLnRvSlMoKTtcbiAgICAgIGRlbGV0ZSBleHBlY3RlZC52ZXJ0aWNlcy52QTtcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIGFjdHVhbCApICkudG9FcXVhbCgge30gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2Fza2VkIHRvIHJlbW92ZSBhIHZlcnRleCBvd25pbmcgc2ltcGxlIGVkZ2VzJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goICgpID0+IHtcbiAgICAgIGRpc3BhdGNoZXIuaGFuZGxlQWN0aW9uKCBSZW1vdmVWZXJ0ZXgoeyB2ZXJ0ZXhJZDogJ3ZDJyB9KSApO1xuICAgIH0gKTtcblxuICAgIGl0KCAncmVtb3ZlcyBpdCBmcm9tIHRoZSBncmFwaCBzdGF0ZSBhbG9uZyB3aXRoIGVkZ2VzIG93bmVkIGJ5IHRoZSB2ZXJ0ZXgnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICBjb25zdCBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApLnRvSlMoKTtcbiAgICAgIGRlbGV0ZSBleHBlY3RlZC52ZXJ0aWNlcy52QztcbiAgICAgIGV4cGVjdGVkLnZlcnRpY2VzLnZBLnBvcnRzLm91dGJvdW5kWyAxIF0uZWRnZUlkID0gbnVsbDtcbiAgICAgIGV4cGVjdGVkLnZlcnRpY2VzLnZCLnBvcnRzLm91dGJvdW5kWyAxIF0uZWRnZUlkID0gbnVsbDtcbiAgICAgIGRlbGV0ZSBleHBlY3RlZC5lZGdlcy5hMDtcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIGFjdHVhbCApICkudG9FcXVhbCgge30gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2Fza2VkIHRvIGRpc2Nvbm5lY3QgYSBzbGF2ZSBwb3J0IGZyb20gYSBjb21wbGV4IGVkZ2Ugd2l0aCAzIG1lbWJlcnMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCggKCkgPT4ge1xuICAgICAgY29uc3QgdmVydGV4ID0gc3RvcmUuZ3JhcGgudmVydGljZXMuZ2V0KCAndkMnICk7XG4gICAgICBjb25zdCBwb3J0ID0gdmVydGV4LnBvcnRzLmluYm91bmQuZ2V0KCAwICk7XG4gICAgICBkaXNwYXRjaGVyLmhhbmRsZUFjdGlvbiggRGlzY29ubmVjdFBvcnQoe1xuICAgICAgICB2ZXJ0ZXg6IHZlcnRleCxcbiAgICAgICAgcG9ydDogcG9ydFxuICAgICAgfSkgKTtcbiAgICB9ICk7XG5cbiAgICBpdCggJ3JlbW92ZXMgaXQgZnJvbSB0aGUgZ3JhcGggc3RhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICBjb25zdCBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApLnRvSlMoKTtcbiAgICAgIGV4cGVjdGVkLnZlcnRpY2VzLnZDLnBvcnRzLmluYm91bmRbIDAgXS5lZGdlSWQgPSBudWxsO1xuICAgICAgZXhwZWN0KCBkaWZmKCBleHBlY3RlZCwgYWN0dWFsICkgKS50b0VxdWFsKCB7fSApO1xuICAgIH0gKTtcbiAgfSApO1xuXG4gIGRlc2NyaWJlKCAnYXNrZWQgdG8gZGlzY29ubmVjdCBhIG1hc3RlciBwb3J0IGZyb20gYSBjb21wbGV4IGVkZ2Ugd2l0aCAzIG1lbWJlcnMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCggKCkgPT4ge1xuICAgICAgY29uc3QgdmVydGV4ID0gc3RvcmUuZ3JhcGgudmVydGljZXMuZ2V0KCAndkInICk7XG4gICAgICBjb25zdCBwb3J0ID0gdmVydGV4LnBvcnRzLm91dGJvdW5kLmdldCggMCApO1xuICAgICAgZGlzcGF0Y2hlci5oYW5kbGVBY3Rpb24oIERpc2Nvbm5lY3RQb3J0KHtcbiAgICAgICAgdmVydGV4OiB2ZXJ0ZXgsXG4gICAgICAgIHBvcnQ6IHBvcnRcbiAgICAgIH0pICk7XG4gICAgfSApO1xuXG4gICAgaXQoICdyZW1vdmVzIGl0IGZyb20gdGhlIGdyYXBoIHN0YXRlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWN0dWFsID0gc3RvcmUuZ3JhcGgudG9KUygpO1xuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjb252ZXJ0LmdyYXBoKCBkYXRhLmluaXRpYWwuZ3JhcGggKS50b0pTKCk7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52Qi5wb3J0cy5vdXRib3VuZFsgMCBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3QoIGRpZmYoIGV4cGVjdGVkLCBhY3R1YWwgKSApLnRvRXF1YWwoIHt9ICk7XG4gICAgfSApO1xuICB9ICk7XG5cbiAgZGVzY3JpYmUoICdhc2tlZCB0byBkaXNjb25uZWN0IHRoZSBvd25pbmcgcG9ydCBmcm9tIGEgc2ltcGxlIGVkZ2UnLCAoKSA9PiB7XG4gICAgdmFyIGV4cGVjdGVkO1xuICAgIGJlZm9yZUVhY2goICgpID0+IHtcbiAgICAgIGNvbnN0IHZlcnRleCA9IHN0b3JlLmdyYXBoLnZlcnRpY2VzLmdldCggJ3ZDJyApO1xuICAgICAgY29uc3QgcG9ydCA9IHZlcnRleC5wb3J0cy5pbmJvdW5kLmdldCggMyApO1xuICAgICAgZGlzcGF0Y2hlci5oYW5kbGVBY3Rpb24oIERpc2Nvbm5lY3RQb3J0KHtcbiAgICAgICAgdmVydGV4OiB2ZXJ0ZXgsXG4gICAgICAgIHBvcnQ6IHBvcnRcbiAgICAgIH0pICk7XG4gICAgICBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApLnRvSlMoKTtcbiAgICB9ICk7XG5cbiAgICBpdCggJ3JlbW92ZXMgdGhlIGVudGlyZSBlZGdlIGZyb20gdGhlIGdyYXBoIHN0YXRlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWN0dWFsID0gc3RvcmUuZ3JhcGgudG9KUygpO1xuICAgICAgZGVsZXRlIGV4cGVjdGVkLmVkZ2VzLmEwO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXMudkMucG9ydHMuaW5ib3VuZFsgMyBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52QS5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52Qi5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3QoIGRpZmYoIGV4cGVjdGVkLCBhY3R1YWwgKSApLnRvRXF1YWwoIHt9ICk7XG4gICAgfSApO1xuICB9ICk7XG5cbiAgZGVzY3JpYmUoICdhc2tlZCB0byBkaXNjb25uZWN0IGEgbm9uLW93bmluZyBwb3J0IGZyb20gYSBzaW1wbGUgZWRnZSB3aXRoIDMgbWVtYmVycycsICgpID0+IHtcbiAgICB2YXIgZXhwZWN0ZWQ7XG4gICAgYmVmb3JlRWFjaCggKCkgPT4ge1xuICAgICAgY29uc3QgdmVydGV4ID0gc3RvcmUuZ3JhcGgudmVydGljZXMuZ2V0KCAndkInICk7XG4gICAgICBjb25zdCBwb3J0ID0gdmVydGV4LnBvcnRzLm91dGJvdW5kLmdldCggMSApO1xuICAgICAgZGlzcGF0Y2hlci5oYW5kbGVBY3Rpb24oIERpc2Nvbm5lY3RQb3J0KHtcbiAgICAgICAgdmVydGV4OiB2ZXJ0ZXgsXG4gICAgICAgIHBvcnQ6IHBvcnRcbiAgICAgIH0pICk7XG4gICAgICBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoIGRhdGEuaW5pdGlhbC5ncmFwaCApLnRvSlMoKTtcbiAgICAgIGV4cGVjdGVkLnZlcnRpY2VzLnZCLnBvcnRzLm91dGJvdW5kWyAxIF0uZWRnZUlkID0gbnVsbDtcbiAgICB9ICk7XG5cbiAgICBpdCggJ2p1c3QgZGlzY29ubmVjdHMgdGhlIHBvcnQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICBleHBlY3QoIGRpZmYoIGV4cGVjdGVkLCBhY3R1YWwgKSApLnRvRXF1YWwoIHt9ICk7XG4gICAgfSApO1xuXG4gICAgZGVzY3JpYmUoICd0aGVuIGFza2VkIHRvIGRpc2Nvbm5lY3QgdGhlIHJlbWFpbmluZyBub24tb3duaW5nIHBvcnQnLCAoKSA9PiB7XG4gICAgICBiZWZvcmVFYWNoKCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZlcnRleCA9IHN0b3JlLmdyYXBoLnZlcnRpY2VzLmdldCggJ3ZBJyApO1xuICAgICAgICBjb25zdCBwb3J0ID0gdmVydGV4LnBvcnRzLm91dGJvdW5kLmdldCggMSApO1xuICAgICAgICBkaXNwYXRjaGVyLmhhbmRsZUFjdGlvbiggRGlzY29ubmVjdFBvcnQoe1xuICAgICAgICAgIHZlcnRleDogdmVydGV4LFxuICAgICAgICAgIHBvcnQ6IHBvcnRcbiAgICAgICAgfSkgKTtcbiAgICAgICAgZXhwZWN0ZWQudmVydGljZXMudkEucG9ydHMub3V0Ym91bmRbIDEgXS5lZGdlSWQgPSBudWxsO1xuICAgICAgfSApO1xuXG4gICAgICBpdCggJ3JlbW92ZXMgdGhlIGVudGlyZSBlZGdlIGZyb20gdGhlIGdyYXBoIHN0YXRlJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICAgIGRlbGV0ZSBleHBlY3RlZC5lZGdlcy5hMDtcbiAgICAgICAgZXhwZWN0ZWQudmVydGljZXMudkMucG9ydHMuaW5ib3VuZFsgMyBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIGFjdHVhbCApICkudG9FcXVhbCgge30gKTtcbiAgICAgIH0gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2Fza2VkIHRvIHJlbW92ZSBhIHNpbXBsZSBlZGdlJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goICgpID0+IHtcbiAgICAgIGRpc3BhdGNoZXIuaGFuZGxlQWN0aW9uKCBSZW1vdmVFZGdlKHsgZWRnZUlkOiAnYTAnIH0pICk7XG4gICAgfSApO1xuXG4gICAgaXQoICdyZW1vdmVzIHRoYXQgZWRnZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGFjdHVhbCA9IHN0b3JlLmdyYXBoLnRvSlMoKTtcbiAgICAgIGV4cGVjdCggYWN0dWFsLmVkZ2VzLmEwICkubm90LnRvQmVEZWZpbmVkKCk7XG4gICAgfSApO1xuXG4gICAgaXQoICdkaXNjb25uZWN0cyBhbGwgcG9ydHMgY29ubmVjdGVkIHRvIGl0JywgKCkgPT4ge1xuICAgICAgY29uc3QgYWN0dWFsID0gc3RvcmUuZ3JhcGgudG9KUygpO1xuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjb252ZXJ0LmdyYXBoKCBkYXRhLmluaXRpYWwuZ3JhcGggKS50b0pTKCk7XG4gICAgICBkZWxldGUgZXhwZWN0ZWQuZWRnZXMuYTA7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52QS5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52Qi5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52Qy5wb3J0cy5pbmJvdW5kWyAzIF0uZWRnZUlkID0gbnVsbDtcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIGFjdHVhbCApICkudG9FcXVhbCgge30gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2Fza2VkIHRvIHJlbW92ZSBhIGNvbXBsZXggZWRnZScsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCAoKSA9PiB7XG4gICAgICBkaXNwYXRjaGVyLmhhbmRsZUFjdGlvbiggUmVtb3ZlRWRnZSh7IGVkZ2VJZDogJ3IwJyB9KSApO1xuICAgIH0gKTtcblxuICAgIGl0KCAncmVtb3ZlcyB0aGF0IGVkZ2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3R1YWwgPSBzdG9yZS5ncmFwaC50b0pTKCk7XG4gICAgICBleHBlY3QoIGFjdHVhbC5lZGdlcy5yMCApLm5vdC50b0JlRGVmaW5lZCgpO1xuICAgIH0gKTtcblxuICAgIGl0KCAnZGlzY29ubmVjdHMgYWxsIHBvcnRzIGNvbm5lY3RlZCB0byBpdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGFjdHVhbCA9IHN0b3JlLmdyYXBoLnRvSlMoKTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkID0gY29udmVydC5ncmFwaCggZGF0YS5pbml0aWFsLmdyYXBoICkudG9KUygpO1xuICAgICAgZGVsZXRlIGV4cGVjdGVkLmVkZ2VzLnIwO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXMudkIucG9ydHMub3V0Ym91bmRbIDAgXS5lZGdlSWQgPSBudWxsO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXMudkMucG9ydHMuaW5ib3VuZFsgMCBdLmVkZ2VJZCA9IG51bGw7XG4gICAgICBleHBlY3RlZC52ZXJ0aWNlcy52RC5wb3J0cy5pbmJvdW5kWyAwIF0uZWRnZUlkID0gbnVsbDtcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIGFjdHVhbCApICkudG9FcXVhbCgge30gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxuICBkZXNjcmliZSggJ2NhbGxlZCB0byBnZW5lcmF0ZSByZW5hbWUgcnVsZXMnLCAoKSA9PiB7XG4gICAgdmFyIHJ1bGVzO1xuICAgIGJlZm9yZUVhY2goICgpID0+IHtcbiAgICAgIGNvbnN0IHBzZXVkb1NlbGVjdGlvbiA9IGNvbnZlcnQuZ3JhcGgoe1xuICAgICAgICB2ZXJ0aWNlczogeyB2QTogZGF0YS5pbml0aWFsLmdyYXBoLnZlcnRpY2VzLnZBIH0sXG4gICAgICAgIGVkZ2VzOiB7IGEwOiBkYXRhLmluaXRpYWwuZ3JhcGguZWRnZXMuYTAgfVxuICAgICAgfSk7XG4gICAgICBydWxlcyA9IHN0b3JlLnJlbmFtZVJ1bGVzKCBwc2V1ZG9TZWxlY3Rpb24gKTtcbiAgICB9ICk7XG5cbiAgICBpdCggJ3Byb3ZpZGVzIGEgbWFwIHRvIGFuIGlzb21vcnBoaWMgZ3JhcGgsIGRpc2pvaW50IHRvIGl0cyBvd24nLCAoKSA9PiB7XG4gICAgICBleHBlY3QoIHJ1bGVzLnRvSlMoKSApLnRvRXF1YWwoIHtcbiAgICAgICAgdmVydGljZXM6IHsgJ3ZBJzogJ3ZBIDEnIH0sXG4gICAgICAgIGVkZ2VzOiB7ICdhMCc6ICdhMCAxJyB9XG4gICAgICB9ICk7XG4gICAgfSApO1xuICB9ICk7XG5cbiAgZGVzY3JpYmUoICdjYWxsZWQgdG8gYXBwbHkgcmVuYW1lIHJ1bGVzJywgKCkgPT4ge1xuICAgIHZhciByZXN1bHQ7XG4gICAgYmVmb3JlRWFjaCggKCkgPT4ge1xuICAgICAgY29uc3QgcHNldWRvU2VsZWN0aW9uID0gY29udmVydC5ncmFwaCh7XG4gICAgICAgIHZlcnRpY2VzOiB7XG4gICAgICAgICAgdkE6IGRhdGEuaW5pdGlhbC5ncmFwaC52ZXJ0aWNlcy52QSxcbiAgICAgICAgICB2QjogZGF0YS5pbml0aWFsLmdyYXBoLnZlcnRpY2VzLnZCXG4gICAgICAgIH0sXG4gICAgICAgIGVkZ2VzOiB7IGEwOiBkYXRhLmluaXRpYWwuZ3JhcGguZWRnZXMuYTAgfVxuICAgICAgfSk7XG4gICAgICBjb25zdCBydWxlcyA9IE1hcCh7XG4gICAgICAgIHZlcnRpY2VzOiBNYXAoeyAndkEnOiAndkEgMScgfSksXG4gICAgICAgIGVkZ2VzOiBNYXAoeyAnYTAnOiAnYTAgMScgfSlcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0ID0gc3RvcmUuYXBwbHlSZW5hbWVSdWxlcyggcHNldWRvU2VsZWN0aW9uLCBydWxlcyApO1xuICAgIH0gKTtcblxuICAgIGl0KCAnZ2VuZXJhdGVzIGFuIGlzb21vcnBoaWMgZ3JhcGggYmFzZWQgb24gdGhlc2UgcnVsZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBleHBlY3RlZCA9IGNvbnZlcnQuZ3JhcGgoe1xuICAgICAgICB2ZXJ0aWNlczoge1xuICAgICAgICAgICd2QSAxJzogZGF0YS5pbml0aWFsLmdyYXBoLnZlcnRpY2VzLnZBLFxuICAgICAgICAgIHZCOiBkYXRhLmluaXRpYWwuZ3JhcGgudmVydGljZXMudkJcbiAgICAgICAgfSxcbiAgICAgICAgZWRnZXM6IHsgJ2EwIDEnOiBkYXRhLmluaXRpYWwuZ3JhcGguZWRnZXMuYTAgfVxuICAgICAgfSkudG9KUygpO1xuICAgICAgZXhwZWN0ZWQuZWRnZXNbICdhMCAxJyBdLmlkID0gJ2EwIDEnO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXNbICd2QSAxJyBdLmlkID0gJ3ZBIDEnO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXNbICd2QSAxJyBdLnBvcnRzLm91dGJvdW5kWyAxIF0uZWRnZUlkID0gJ2EwIDEnO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXNbICd2QicgXS5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9ICdhMCAxJztcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIHJlc3VsdC50b0pTKCkgKSApLnRvRXF1YWwoIHt9ICk7XG4gICAgfSApO1xuICB9ICk7XG5cbiAgZGVzY3JpYmUoICdjYWxsZWQgdG8gaW5zZXJ0IGEgZGlzam9pbnQgZ3JhcGgnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCggKCkgPT4ge1xuICAgICAgY29uc3QgcHNldWRvU2VsZWN0aW9uID0gY29udmVydC5ncmFwaCh7XG4gICAgICAgIHZlcnRpY2VzOiB7IHZBOiBkYXRhLmluaXRpYWwuZ3JhcGgudmVydGljZXMudkEgfSxcbiAgICAgICAgZWRnZXM6IHsgYTA6IGRhdGEuaW5pdGlhbC5ncmFwaC5lZGdlcy5hMCB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHJ1bGVzID0gTWFwKHtcbiAgICAgICAgdmVydGljZXM6IE1hcCh7ICd2QSc6ICd2QSAxJyB9KSxcbiAgICAgICAgZWRnZXM6IE1hcCh7ICdhMCc6ICdhMCAxJyB9KVxuICAgICAgfSk7XG4gICAgICBjb25zdCBzdWJHcmFwaCA9IHN0b3JlLmFwcGx5UmVuYW1lUnVsZXMoIHBzZXVkb1NlbGVjdGlvbiwgcnVsZXMgKTtcbiAgICAgIHN0b3JlLmluc2VydCggc3ViR3JhcGggKTtcbiAgICB9ICk7XG5cbiAgICBpdCggJ2V4dGVuZHMgaXRzIG93biBncmFwaCB3aXRoIHRoZSBzdXBwbGllZCBncmFwaCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHZBMSA9IGNvcHkoIGRhdGEuaW5pdGlhbC5ncmFwaC52ZXJ0aWNlcy52QSApO1xuICAgICAgdkExLmlkID0gJ3ZBIDEnO1xuICAgICAgdkExLnBvcnRzLm91dGJvdW5kWyAxIF0uZWRnZUlkID0gJ2EwIDEnO1xuICAgICAgY29uc3QgYTAxID0gY29weSggZGF0YS5pbml0aWFsLmdyYXBoLmVkZ2VzLmEwICk7XG4gICAgICBhMDEuaWQgPSAnYTAgMSc7XG4gICAgICBjb25zdCBleHBlY3RlZCA9IGNvcHkoIGRhdGEuaW5pdGlhbC5ncmFwaCApO1xuICAgICAgZXhwZWN0ZWQuZWRnZXNbICdhMCAxJyBdID0gYTAxO1xuICAgICAgZXhwZWN0ZWQudmVydGljZXNbICd2QSAxJyBdID0gdkExO1xuICAgICAgZXhwZWN0KCBkaWZmKCBleHBlY3RlZCwgc3RvcmUuZ3JhcGgudG9KUygpICkgKS50b0VxdWFsKCB7fSApO1xuICAgIH0gKTtcbiAgfSApO1xuXG4gIGRlc2NyaWJlKCAnY2FsbGVkIHRvIGluc2VydCBhbiBvdmVybGFwcGluZyBncmFwaCB3aXRoIHJlbmFtZSBydWxlcycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCAoKSA9PiB7XG4gICAgICBjb25zdCBwc2V1ZG9TZWxlY3Rpb24gPSBjb252ZXJ0LmdyYXBoKHtcbiAgICAgICAgdmVydGljZXM6IHsgdkE6IGRhdGEuaW5pdGlhbC5ncmFwaC52ZXJ0aWNlcy52QSB9LFxuICAgICAgICBlZGdlczogeyBhMDogZGF0YS5pbml0aWFsLmdyYXBoLmVkZ2VzLmEwIH1cbiAgICAgIH0pO1xuICAgICAgY29uc3QgcnVsZXMgPSBNYXAoe1xuICAgICAgICB2ZXJ0aWNlczogTWFwKHsgJ3ZBJzogJ3ZBIDEnIH0pLFxuICAgICAgICBlZGdlczogTWFwKHsgJ2EwJzogJ2EwIDEnIH0pXG4gICAgICB9KTtcbiAgICAgIHN0b3JlLmluc2VydCggcHNldWRvU2VsZWN0aW9uLCBydWxlcyApO1xuICAgIH0gKTtcblxuICAgIGl0KCAnZXh0ZW5kcyBpdHMgb3duIGdyYXBoIHdpdGggdGhlIHJlbmFtZWQgc3VwcGxpZWQgZ3JhcGgnLCAoKSA9PiB7XG4gICAgICBjb25zdCB2QTEgPSBjb3B5KCBkYXRhLmluaXRpYWwuZ3JhcGgudmVydGljZXMudkEgKTtcbiAgICAgIHZBMS5pZCA9ICd2QSAxJztcbiAgICAgIHZBMS5wb3J0cy5vdXRib3VuZFsgMSBdLmVkZ2VJZCA9ICdhMCAxJztcbiAgICAgIGNvbnN0IGEwMSA9IGNvcHkoIGRhdGEuaW5pdGlhbC5ncmFwaC5lZGdlcy5hMCApO1xuICAgICAgYTAxLmlkID0gJ2EwIDEnO1xuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjb3B5KCBkYXRhLmluaXRpYWwuZ3JhcGggKTtcbiAgICAgIGV4cGVjdGVkLmVkZ2VzWyAnYTAgMScgXSA9IGEwMTtcbiAgICAgIGV4cGVjdGVkLnZlcnRpY2VzWyAndkEgMScgXSA9IHZBMTtcbiAgICAgIGV4cGVjdCggZGlmZiggZXhwZWN0ZWQsIHN0b3JlLmdyYXBoLnRvSlMoKSApICkudG9FcXVhbCgge30gKTtcbiAgICB9ICk7XG4gIH0gKTtcblxufSApO1xuXG5mdW5jdGlvbiBjb3B5KCBvICkge1xuICByZXR1cm4gSlNPTi5wYXJzZSggSlNPTi5zdHJpbmdpZnkoIG8gKSApO1xufVxuIl19